# E-Shopper
### Описание:

Учебный проект E-Shopper, интренет магазин техники.

На сайте реализованы:
- минифрэймворк с использованием паттерна **front controller + MVC**.
- постраничная пагинация на страинцах каталог товаров и категория товаров
- регистрация, авторизация и личный кабинет
- форма обратной связи (отправка email сообщений администратору сайта)
- добавление товаров в корзину использую **AJAX**, удаление товаров из корзины
- оформление заказа товаров, сохранение заказа в базе в **JSON** формате, отправка email уведомления админу сайта
- администрирование сайтом: управелние товарами, категориями, заказами

Тестовые пользователи:
- Администратор сайт: admin@mail.com:Qw12345
- Пользователь: user@mail.com:Qw12345
    
### Ядро
1. Каркас системы реализован при помощи паттерна MVC и front controller:
    - Любой запрос приходящий на сервер перенаправляется на index.php (front controller)
    - Перенаправление осуществлено с помощью .htaccess (RewriteRule ^(.*)$ index.php)
    - Далее front controller передает управление роутеру (/components/Router.php)
    - Роутер анализирует строку запроса в виде **ЧПУ** и определять контроллер, метод(action) и параметры
    - Класс Router обращается к заготовленными нами маршрутами (/config/routers.php)
    - Получает из URL название контроллера, название метода(action) и параметры, согласно маршруту
    - Передает данному контроллеру управление, пример: https://localhost/product/23 -> /controllers/ProductController.php -> actionView(23)
    - Метод контроллера (actionView) обращается к определенному методу модели, пример: /models/Product.php::getProductById(23)
    - Далее метод контроллера обрабатывает и передает полученные данные представлению, например: /views/product/view.php
  
2. База данных, взаимодействие c БД реализовано с использованием **PDO**:
    - Подключение к БД осуществляется в классе /components/Db.php
    - Настройки подключения к БД: /config/db_params.php
    - Дамп БД c пользователями и товарами: /e-shopper.sql
  
3. Авто загрузка классов.
    - Реализована при помощи функции spl_autoload_register(), файл расположен /components/Autoload.php
   
4. Отправка email сообщений
    - Реализовано при помощи библиотеки swiftmailer
    - Конфигурационный файл /config/email_params.php
    - Класс Email (/components/Email.php)
    > При отправке email сообщения может возникнуть ошибка, из-за того что smpt настроен через gmail. Периодически он блокирует отправку почты через smtp, для проверки работы отправки сообщений укажите свои параметры smtp сервера в файле /config/email_params.php
   
  
### Пользовательская часть сайта
1. Главная страница (SiteController actionIndex)
    - Последние товары
    - Слайдер рекомендуемых товаров

2. Каталог
    - Главная страница каталога с пагинацией (CatalogController actionIndex)
    - Страница категорий с пагинацией (CatalogController actionCategory($categoryId))
    - Страница товара (ProductController actionView($productId))
    
3. Форма обратной связи (отправка email сообщений от пользователя)
    - Страница контакты (SiteController actionContact)
    
3. Корзина (CartController actionIndex)
    - Добавление товара в корзину использую AJAX, скрипт расположен в /layouts/footer.php
    - Удаление товара из корзины
    - Оформление заказа, запись JSON с заказами в БД и отправка email уведомления администратору сайта

4. Личный кабинет пользователя
    - Регистрация (UserController actionRegistration)
    - Авторизация (UserController actionLogin)
    - Кабинет (CabinetController actionIndex)


### Административная часть сайта
1. Главная страница админпанели (AdminBase -> AdminController actionIndex)
    - Управление категориями (Добавление, изменение, удаление)
    - Управление заказами (Просмотр, изменение, удаление)
    - Управление товарами (Добавление, изменение, удаление)